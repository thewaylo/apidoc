<!DOCTYPE html>
<html lang="en">

  
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Waylo helps chatbot owners to improve human-to-bot communication. Identify bottlenecks, filter conversations, and understand engagement.">

    <meta name="author" content="">
 <!-- <meta property="og:image" content="/static/images/preview.png"/>-->
          <meta content="/static/new_index/assets/img/preview.png" property="og:image">
     <!--<link rel="icon" href = '/static/conversations/fav.png'  type="image/png" sizes="16x16">-->
     <link  rel="shortcut icon" type="image/ico" href="http://www.iconeasy.com/icon/ico/System/Fruity%20Apples/Orange.ico">

    <title>Waylo - Documentation</title>

    <!-- Bootstrap core CSS -->
    <script src="../../static/conversations/tether.js"></script>

		<link href="../../static/css/bootstrap.css" rel="stylesheet">

		<script src="../../static/conversations/jquery.js"></script>
 		<script src="../../static/conversations/bootstrap.js"></script>



<!--Google Analytcis-->

   <script type="text/javascript">
    $(document).ready(function(){
    $('#collapse1').collapse("hide");
    $('#collapse2').collapse("hide");
  });
  </script>
  </head>

  <body style = "background-color:#fff">

    <nav class="navbar navbar-fixed-top navbar-light bg-faded">
      <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2">
        &#9776;
      </button>
      <div class="collapse navbar-toggleable-xs container" id="exCollapsingNavbar2">
      <!--<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"-->
      <!--     width="173px" height="42px" viewBox="0 0 173 42" enable-background="new 0 0 173 42" xml:space="preserve" style = "margin-top:2px;float:left;">-->
      <!--  <g>-->
      <!--    <g>-->
      <!--      <path fill="#FFFFFF" d="M52.16,28.771h-0.026v0.939c0,0.156-0.104,0.262-0.261,0.262h-2.401c-0.156,0-0.261-0.105-0.261-0.262-->
      <!--        V12.488c0-0.157,0.105-0.261,0.261-0.261h2.401c0.157,0,0.261,0.104,0.261,0.261v6.106h0.026c0.6-0.861,1.644-1.488,3.34-1.488-->
      <!--        c2.14,0,3.706,1.018,4.357,3.027c0.313,0.966,0.444,1.853,0.444,3.55c0,1.695-0.13,2.583-0.444,3.548-->
      <!--        c-0.652,2.011-2.218,3.028-4.357,3.028C53.804,30.26,52.759,29.633,52.16,28.771z M57.065,26.031-->
      <!--        c0.183-0.574,0.261-1.2,0.261-2.348c0-1.148-0.078-1.775-0.261-2.349c-0.339-1.044-1.148-1.618-2.323-1.618-->
      <!--        c-1.2,0-2.01,0.574-2.348,1.618c-0.183,0.574-0.261,1.201-0.261,2.349c0,1.147,0.078,1.773,0.261,2.348-->
      <!--        c0.338,1.044,1.148,1.619,2.348,1.619C55.917,27.65,56.726,27.075,57.065,26.031z"/>-->
      <!--      <path fill="#FFFFFF" d="M61.972,26.788c-0.287-0.887-0.417-1.722-0.417-3.104c0-1.384,0.13-2.219,0.417-3.106-->
      <!--        c0.705-2.192,2.636-3.471,5.193-3.471c2.531,0,4.462,1.279,5.167,3.471c0.287,0.887,0.417,1.722,0.417,3.106-->
      <!--        c0,1.383-0.13,2.218-0.417,3.104c-0.704,2.192-2.636,3.472-5.167,3.472C64.607,30.26,62.676,28.98,61.972,26.788z M69.513,26.006-->
      <!--        c0.208-0.652,0.261-1.253,0.261-2.322c0-1.07-0.053-1.645-0.261-2.323c-0.365-1.044-1.175-1.644-2.348-1.644-->
      <!--        c-1.175,0-2.01,0.6-2.375,1.644c-0.208,0.679-0.261,1.253-0.261,2.323c0,1.069,0.053,1.67,0.261,2.322-->
      <!--        c0.366,1.044,1.201,1.645,2.375,1.645C68.338,27.65,69.148,27.05,69.513,26.006z"/>-->
      <!--      <path fill="#FFFFFF" d="M78.65,30.129c-2.531,0-3.497-1.227-3.497-3.68V19.82c0-0.104-0.052-0.156-0.157-0.156h-0.835-->
      <!--        c-0.157,0-0.261-0.104-0.261-0.261v-1.749c0-0.157,0.104-0.261,0.261-0.261h0.835c0.104,0,0.157-0.053,0.157-0.157v-3.445-->
      <!--        c0-0.157,0.104-0.261,0.261-0.261h2.401c0.157,0,0.261,0.104,0.261,0.261v3.445c0,0.104,0.053,0.157,0.157,0.157h1.67-->
      <!--        c0.157,0,0.261,0.104,0.261,0.261v1.749c0,0.157-0.104,0.261-0.261,0.261h-1.67c-0.104,0-0.157,0.053-0.157,0.156v6.524-->
      <!--        c0,0.887,0.366,1.175,1.174,1.175h0.653c0.157,0,0.261,0.104,0.261,0.26v2.088c0,0.156-0.104,0.262-0.261,0.262H78.65z"/>-->
      <!--      <path fill="#FFFFFF" d="M90.217,29.973c-0.156,0-0.262-0.105-0.262-0.262v-0.913H89.93c-0.6,0.861-1.775,1.462-3.549,1.462-->
      <!--        c-2.297,0-4.228-1.201-4.228-3.836c0-2.74,1.931-3.994,5.037-3.994h2.557c0.105,0,0.156-0.052,0.156-0.156v-0.6-->
      <!--        c0-1.435-0.678-2.087-2.791-2.087c-1.409,0-2.271,0.392-2.871,0.861c-0.131,0.104-0.288,0.078-0.366-0.052l-0.965-1.723-->
      <!--        c-0.078-0.13-0.053-0.261,0.052-0.339c1.018-0.73,2.401-1.227,4.462-1.227c3.837,0,5.246,1.305,5.246,4.385v8.22-->
      <!--        c0,0.156-0.104,0.262-0.262,0.262H90.217z M89.902,25.744v-0.965c0-0.104-0.051-0.156-0.156-0.156h-2.087-->
      <!--        c-1.878,0-2.714,0.521-2.714,1.695c0,1.045,0.757,1.566,2.166,1.566C88.912,27.885,89.902,27.18,89.902,25.744z"/>-->
      <!--      <path fill="#FFFFFF" d="M102.844,29.973c-0.156,0-0.261-0.105-0.261-0.262v-7.254c0-1.618-0.809-2.74-2.375-2.74-->
      <!--        c-1.513,0-2.401,1.122-2.401,2.74v7.254c0,0.156-0.104,0.262-0.26,0.262h-2.401c-0.157,0-0.261-0.105-0.261-0.262V17.655-->
      <!--        c0-0.157,0.104-0.261,0.261-0.261h2.401c0.156,0,0.26,0.104,0.26,0.261v0.913h0.027c0.547-0.782,1.643-1.461,3.314-1.461-->
      <!--        c2.688,0,4.357,1.984,4.357,4.671v7.933c0,0.156-0.104,0.262-0.262,0.262H102.844z"/>-->
      <!--      <path fill="#FFFFFF" d="M115.184,29.973c-0.156,0-0.261-0.105-0.261-0.262v-0.913h-0.025c-0.601,0.861-1.774,1.462-3.55,1.462-->
      <!--        c-2.296,0-4.227-1.201-4.227-3.836c0-2.74,1.931-3.994,5.036-3.994h2.558c0.104,0,0.156-0.052,0.156-0.156v-0.6-->
      <!--        c0-1.435-0.679-2.087-2.792-2.087c-1.409,0-2.271,0.392-2.871,0.861c-0.13,0.104-0.286,0.078-0.364-0.052l-0.966-1.723-->
      <!--        c-0.079-0.13-0.053-0.261,0.052-0.339c1.018-0.73,2.4-1.227,4.463-1.227c3.835,0,5.244,1.305,5.244,4.385v8.22-->
      <!--        c0,0.156-0.104,0.262-0.26,0.262H115.184z M114.871,25.744v-0.965c0-0.104-0.053-0.156-0.156-0.156h-2.088-->
      <!--        c-1.879,0-2.714,0.521-2.714,1.695c0,1.045,0.757,1.566,2.166,1.566C113.879,27.885,114.871,27.18,114.871,25.744z"/>-->
      <!--      <path fill="#FFFFFF" d="M123.535,30.129c-2.453,0-3.444-1.175-3.444-3.602V12.488c0-0.157,0.104-0.261,0.261-0.261h2.4-->
      <!--        c0.157,0,0.262,0.104,0.262,0.261v13.883c0,0.86,0.339,1.148,1.096,1.148h0.574c0.156,0,0.261,0.104,0.261,0.26v2.088-->
      <!--        c0,0.156-0.104,0.262-0.261,0.262H123.535z"/>-->
      <!--      <path fill="#FFFFFF" d="M126.533,34.669c-0.156,0-0.262-0.104-0.262-0.261V32.32c0-0.156,0.105-0.26,0.262-0.26h0.47-->
      <!--        c0.991,0,1.487-0.443,1.88-1.488l0.365-1.07l-4.594-11.847c-0.053-0.157,0.053-0.261,0.209-0.261h2.584-->
      <!--        c0.156,0,0.26,0.104,0.312,0.261l2.844,8.22h0.053l2.714-8.22c0.052-0.157,0.157-0.261,0.313-0.261h2.479-->
      <!--        c0.156,0,0.262,0.104,0.209,0.261l-4.802,13.101c-1.097,2.975-2.14,3.913-4.228,3.913H126.533z"/>-->
      <!--      <path fill="#FFFFFF" d="M142.385,30.129c-2.531,0-3.496-1.227-3.496-3.68V19.82c0-0.104-0.053-0.156-0.157-0.156h-0.835-->
      <!--        c-0.156,0-0.262-0.104-0.262-0.261v-1.749c0-0.157,0.105-0.261,0.262-0.261h0.835c0.104,0,0.157-0.053,0.157-0.157v-3.445-->
      <!--        c0-0.157,0.104-0.261,0.26-0.261h2.401c0.157,0,0.261,0.104,0.261,0.261v3.445c0,0.104,0.053,0.157,0.157,0.157h1.67-->
      <!--        c0.156,0,0.261,0.104,0.261,0.261v1.749c0,0.157-0.104,0.261-0.261,0.261h-1.67c-0.104,0-0.157,0.053-0.157,0.156v6.524-->
      <!--        c0,0.887,0.366,1.175,1.174,1.175h0.653c0.156,0,0.261,0.104,0.261,0.26v2.088c0,0.156-0.104,0.262-0.261,0.262H142.385z"/>-->
      <!--      <path fill="#FFFFFF" d="M146.433,15.019c-0.156,0-0.261-0.104-0.261-0.261v-2.27c0-0.157,0.104-0.261,0.261-0.261h2.401-->
      <!--        c0.156,0,0.261,0.104,0.261,0.261v2.27c0,0.157-0.104,0.261-0.261,0.261H146.433z M146.433,29.973-->
      <!--        c-0.156,0-0.261-0.105-0.261-0.262V17.655c0-0.157,0.104-0.261,0.261-0.261h2.401c0.156,0,0.261,0.104,0.261,0.261v12.056-->
      <!--        c0,0.156-0.104,0.262-0.261,0.262H146.433z"/>-->
      <!--      <path fill="#FFFFFF" d="M151.417,26.788c-0.261-0.782-0.392-1.774-0.392-3.104c0-1.332,0.131-2.323,0.392-3.106-->
      <!--        c0.731-2.245,2.661-3.471,5.193-3.471c1.879,0,3.366,0.757,4.358,1.958c0.077,0.104,0.104,0.261-0.026,0.365l-1.644,1.436-->
      <!--        c-0.131,0.104-0.262,0.078-0.365-0.053c-0.627-0.704-1.279-1.095-2.323-1.095c-1.122,0-1.983,0.548-2.349,1.644-->
      <!--        c-0.209,0.626-0.262,1.357-0.262,2.323c0,0.965,0.053,1.722,0.262,2.348c0.365,1.07,1.227,1.619,2.349,1.619-->
      <!--        c1.044,0,1.696-0.393,2.323-1.097c0.104-0.13,0.234-0.13,0.365-0.026l1.644,1.436c0.13,0.104,0.104,0.234,0.026,0.365-->
      <!--        c-0.992,1.174-2.479,1.932-4.358,1.932C154.078,30.26,152.148,29.033,151.417,26.788z"/>-->
      <!--      <path fill="#FFFFFF" d="M162.143,28.276c-0.104-0.104-0.104-0.262,0-0.365l1.487-1.566c0.104-0.104,0.261-0.104,0.365,0-->
      <!--        c0.913,0.835,2.375,1.435,3.681,1.435c1.539,0,2.322-0.625,2.322-1.487c0-0.757-0.444-1.226-2.088-1.382l-1.357-0.131-->
      <!--        c-2.558-0.262-3.863-1.566-3.863-3.706c0-2.427,1.75-3.967,4.881-3.967c1.958,0,3.602,0.653,4.724,1.54-->
      <!--        c0.13,0.104,0.13,0.261,0.052,0.366l-1.277,1.54c-0.105,0.13-0.235,0.13-0.367,0.052c-0.782-0.549-2.034-1.043-3.287-1.043-->
      <!--        s-1.904,0.548-1.904,1.305c0,0.73,0.443,1.174,2.061,1.33l1.357,0.131c2.635,0.262,3.888,1.618,3.888,3.68-->
      <!--        c0,2.505-1.825,4.254-5.271,4.254C164.961,30.26,163.187,29.242,162.143,28.276z"/>-->
      <!--    </g>-->
      <!--    <g>-->
      <!--      <path fill="#FFFFFF" d="M12.705,30.082c0.397,0,0.722,0.322,0.722,0.72l-0.002,4.086c0,0.397,0.251,0.517,0.559,0.265l5.638-4.615-->
      <!--        c0.308-0.252,0.884-0.457,1.281-0.457l9.327,0.006c1.108-0.065,2.05-1.371,2.117-2.417l-0.012-13.032-->
      <!--        c0-0.397,0.325-0.637,0.723-0.637h1.806c0.397,0,0.722,0.239,0.722,0.637l0.018,13.361c0,2.889-2.185,6.002-5.435,6.002l0,0-->
      <!--        h-8.104c-0.397,0-0.974-0.129-1.281,0.122L10.73,42.184c-0.308,0.252-0.559,0.049-0.559-0.348l0.004-7.742-->
      <!--        c0-0.396-0.325-0.743-0.722-0.743L5.83,33.346c-2.824,0-5.676-2.76-5.83-5.586v-5.625C0,21.737,0.518,22,0.916,22h1.806-->
      <!--        c0.397,0,0.722,0.031,0.722,0.428l0.019,5.271c0,1.018,1.272,2.291,2.323,2.453L12.705,30.082z"/>-->
      <!--      <g>-->
      <!--        <path fill="#FFFFFF" d="M8.031,18.967c-0.185,0.352-0.661,0.639-1.059,0.639H0.916c-0.397,0-0.722-0.325-0.722-0.722v-1.806-->
      <!--          c0-0.397,0.325-0.722,0.722-0.722h4.092c0.397,0,0.874-0.288,1.059-0.639L11.546,5.31c0.185-0.351,0.509-0.364,0.72-0.028-->
      <!--          l4.625,7.358c0.212,0.337,0.542,0.327,0.734-0.021l6.451-11.673c0.192-0.347,0.525-0.358,0.74-0.024l4.423,6.88-->
      <!--          c0.215,0.334,0.715,0.607,1.113,0.607h4.511c0.397,0,0.722,0.325,0.722,0.723v1.805c0,0.397-0.325,0.723-0.722,0.723h-6.288-->
      <!--          c-0.397,0-0.898-0.273-1.113-0.607l-2.44-3.785c-0.215-0.334-0.549-0.323-0.741,0.025l-6.476,11.713-->
      <!--          c-0.192,0.347-0.522,0.356-0.734,0.021l-4.552-7.247c-0.211-0.336-0.536-0.324-0.721,0.027L8.031,18.967z"/>-->
      <!--      </g>-->
      <!--    </g>-->
      <!--  </g>-->
      <!--  </svg>-->
      </div>
    </nav>



    <div class="container" style = "margin-top:100px;">
      <!-- Nav tabs -->
  <ul id="platform" class="nav nav-tabs" role="tablist" style = "margin-top:-50px;margin-bottom:20px;">
    <li class="nav-item">
      <a class="nav-link active" style="color:#55595c !important" data-toggle="tab" href="#facebook" role="tab">Facebook Messenger</a>
    </li>
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#slack" role="tab">Slack</a>-->
    <!--</li>-->
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#google" role="tab">Google Assistant</a>-->
    <!--</li>-->
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#wechat" role="tab">WeChat</a>-->
    <!--</li>-->
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#kik" role="tab">Kik</a>-->
    <!--</li>-->
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#viber" role="tab">Viber</a>-->
    <!--</li>-->
    <!-- <li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#line" role="tab">Line</a>-->
    <!--</li>-->
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#twilio" role="tab">Twilio Sms</a>-->
    <!--</li>-->
    <!--<li class="nav-item" stype="display:none;">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#microsoft" role="tab">Microsoft Bot Framework</a>-->
    <!--</li>-->
    <!-- <li class="nav-item" stype="display:none;">
      <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#smooch" role="tab">Smooch</a>
    </li>-->
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#generic" role="tab">Generic</a>-->
    <!--</li>-->
    <!--<li class="nav-item">-->
    <!--  <a class="nav-link " style="color:#55595c !important" data-toggle="tab" href="#live" role="tab">Live Chat</a>-->
    <!--</li>-->
  </ul>
  <!-- Tab panes -->
 <div class="tab-content">
   <div class="tab-pane active" id="facebook" role="tabpanel">
     <!--<h1 class = "docu-main-h">Documentation</h1>-->
     <h2 class = "docu-header" style = "font-size:22px;margin-bottom:30px;">Messages</h2>
     <h2 class = "docu-header">Parameters</h2>
     <p class = "docu-p">Obtain your <code>API KEY</code> and submit your <code>MESSENGER PAGE ACCESS TOKEN</code>,<code>PAUSE WEBHOOK</code> prior to integration</p>

     <h2 class = "docu-header">Request</h2>
     <p class = "docu-p">In order to send incoming/out-going messages to Waylo, make a  <code>POST</code>call to<code>https://wayloapi.herokuapp.com/webhook</code></p>
     <h3 class = "docu-m-header">Example</h3>
     <pre class = "docu-pre">
         <span class = "docu-w-sp">
curl <span class = "docu-gr-sp"> "https://wayloapi.herokuapp.com/webhook?apikey=[YOUR KEY]&paused=[pausedState=true/false]"</span> \
-X POST \
-H 'Content-Type: application/json' \
-d
'{
    "message": see below incoming/out-going message structures.
}'             </span>
</pre>
     <h3 class = "docu-m-header">Fields</h3>
     <table class="table table-striped table-bordered table-sm">
       <thead>
         <tr>
           <th>Field Name</th>
           <th>Description</th>
           <th>Type</th>
           <th>Required</th>
         </tr>
       </thead>
       <tbody>
         <tr>
           <td style = "color:#42b72a">message</td>
           <td>Message</td>
           <td>JSON</td>
           <td>Yes</td>
         </tr>
         <!--<tr>-->
         <!--  <td style = "color:#42b72a">recipient</td>-->
         <!--  <td>Recipient</td>-->
         <!--  <td>String</td>-->
         <!--   <td>Yes</td>-->
         <!--</tr>4-->

         <!--<tr>-->
         <!--  <td style = "color:#42b72a">timestamp</td>-->
         <!--  <td>Timestamp</td>-->
         <!--  <td>Number</td>-->
         <!--   <td>Yes</td>-->
         <!--</tr>-->
         <!--<tr>-->
         <!--  <td style = "color:#42b72a">notification_type</td>-->
         <!--  <td>Notification Type</td>-->
         <!--  <td>Push notification type: REGULAR, SILENT_PUSH, NO_PUSH</td>-->
         <!--  <td>No</td>-->
         <!--</tr>-->
       </tbody>
     </table>





     <h4 class = "docu-m-header">Simple Node.js code example</h4>
     <!--<p class = "docu-p">Below you can see a function track is defined and called for incoming and out-going messages. </p>-->
     <pre class = "docu-pre" style = "padding-top:20px;padding-bottom:0px;">
     <span class = "docu-gr-sp-r" style = "margin-left:-30px;"><span class = "docu-w-sp-r"></span>
var request = require('request');

/******************** Waylo function with the API endpoint       **************/

function wayloapi(message){

  const userid = message.entry[0].id===message.entry[0].messaging[0].sender.id? message.entry[0].messaging[0].recipient.id : message.entry[0].messaging[0].sender.id;
  var pausedState = pausedUsers[userid] ? pausedUsers[userid] : false;
  var options = { method: 'POST',
    url: 'https://wayloapi.herokuapp.com/webhook',                              //URL will cbe different for the final API version
    qs: {
      apikey: <YOUR API KEY>,
      paused: pausedState
    },
    headers: 
     {'content-type': 'application/json' },
    body: message,
    json: true };

  request(options, function(error, response, body){

         if(error) {
           console.log(error)
         } else {
           console.log(response.statusCode, body)
         }
    });

}



/**** Log incoming messages and postbacks *********/

app.post('/webhook', function (req, res) {
  var data = req.body;
  wayloapi(req.body);                                             // logging inputs


  if (data.object == 'page') {
    // Iterate over each entry
    // There may be multiple if batched
    data.entry.forEach(function(pageEntry) {
      var pageID = pageEntry.id;
      var timeOfEvent = pageEntry.time;

      // Iterate over each messaging event
      pageEntry.messaging.forEach(function(messagingEvent) {

        const senderID=  messagingEvent.sender.id;

        if(!pausedUsers[senderID]){                               // Note the bot pause part
          if (messagingEvent.optin) {
            receivedAuthentication(messagingEvent);
          } else if (messagingEvent.message) {
            receivedMessage(messagingEvent);
          } else if (messagingEvent.delivery) {
            receivedDeliveryConfirmation(messagingEvent);
          } else if (messagingEvent.postback) {
            receivedPostback(messagingEvent);
          } else if (messagingEvent.read) {
            receivedMessageRead(messagingEvent);
          } else if (messagingEvent.account_linking) {
            receivedAccountLink(messagingEvent);
          } else {
            console.log("Webhook received unknown messagingEvent: ", messagingEvent);
          }
        }
      });
    });

    // Assume all went well.
    //
    // You must send back a 200, within 20 seconds, to let us know you've 
    // successfully received the callback. Otherwise, the request will time out.
    res.sendStatus(200);
  }
});




/***************Bot pause ******************************/

var jsonParser = bodyParser.json();

// Test Bot pause

app.get('/pause', function(req, res) {
    console.log("pause");
    res.send(200);    
});


var pausedUsers = {};  // Implement this in the datebase to make it more robust
app.post('/pause', jsonParser, function (req, res) {
  const userId = req.query.userId;
  const paused = (req.query.paused === "true");
  pausedUsers[userId] = paused;                      
  res.send("ok")
})



/*************Button to pause bot and start Waylo Hotel booking *********/

var buttonData = {
  recipient: {
    id: userId                             // Make sure this is the id of the user
  },
  message: {
    attachment: {
      type: "template",
      payload: {
        template_type: "button",
        text: 'Ciao until next time :)',    // Bot maker is free to choose this text
        buttons:[ 
        {
          type: "postback",
          title: "Book hotel",              // Bot maker is free to choose this text
          payload: "pause=hotel"            // Do not change payload. Handle the payload in your logic if can
          
        }

        ]
      }
    }
  }
};  

callSendAPI(buttonData);                   // Call Messenger API




/********************* callSendAPI (Messenger API call) **************/


function callSendAPI(messageData) {
  wayloapi(messageData)                                          // Log outgoing message
  request({
    uri: 'https://graph.facebook.com/v2.8/me/messages',
    qs: { access_token: PAGE_ACCESS_TOKEN },
    method: 'POST',
    json: messageData

  }, function (error, response, body) {
    if (!error && response.statusCode == 200) {
      var recipientId = body.recipient_id;
      var messageId = body.message_id;

      if (messageId) {
        console.log("Successfully sent message with id %s to recipient %s", 
          messageId, recipientId);
      } else {
      console.log("Successfully called Send API for recipient %s", 
        recipientId);
      }
    } else {
      console.error("Failed calling Send API", response.statusCode, response.statusMessage, body.error);
    }
  });  
}

     </pre>
     <h2 class = "docu-header" style = "font-size:22px;margin-bottom:30px;margin-top:40px;">Response Meanings</h2>
     <table class="table table-striped table-bordered table-sm">
       <thead>
         <tr>
           <th>Response Code</th>
           <th>Meaning</th>
         </tr>
       </thead>
       <tbody>
         <tr>
           <td style = "color:#222;font-weight:500;">200</td>
           <td>OK – Everything worked as expected.</td>
         </tr>
         <tr>
           <td style = "color:#222;font-weight:500;">400</td>
           <td>Bad Request – The request was unacceptable, often due to missing a required parameter.</td>
         </tr>
         <tr>
           <td style = "color:#222;font-weight:500;">401</td>
           <td>Unauthorized – Your api token is wrong</td>
         </tr>
         <tr>
           <td style = "color:#222;font-weight:500;">404</td>
           <td>Not Found – The requested resource doesn't exist.</td>
         </tr>
         <tr>
           <td style = "color:#222;font-weight:500;">500, 502, 503, 504</td>
           <td>Server Errors – Something went wrong on Waylo's end. Try again later. (These are rare.) </td>
         </tr>
       </tbody>
     </table>
 </div>

 <script>
 $('#platform a').click(function (e) {
  e.preventDefault();
  $(this).tab('show');
});
$('#google-platform a').click(function (e) {
  e.preventDefault();
  $(this).tab('show');
});
 </script>
  </body>

</html>
